{% extends 'base.html' %}

{% block title %}Dashboard - ParentPlanner{% endblock %}

{% block extra_head %}
<!-- Optimized dashboard assets -->
{% load static %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
<link rel="stylesheet" href="{% static 'css/dashboard-scroll.css' %}">
<script src="{% static 'js/dashboard-optimized.js' %}" defer></script>
<script src="{% static 'js/color_picker.js' %}" defer></script>

<style>
/* Color Picker Styling */
.color-grid-widget {
    margin: 0.5rem 0;
}

.color-dots-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 0.5rem;
    padding: 1rem;
    background-color: #f9fafb;
    border: 2px solid #4F46E5;
    max-width: 250px;
}

.color-dot {
    width: 2rem;
    height: 2rem;
    border: 2px solid #6b7280;
    cursor: pointer;
    transition: all 0.2s ease;
    justify-self: center;
    border-radius: 50%;
}

.color-dot:hover {
    transform: scale(1.1);
    border-color: #111827;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.color-dot.selected {
    border-color: #4f46e5;
    transform: scale(1.15);
    box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.3), 0 2px 8px rgba(0, 0, 0, 0.3);
    border-width: 3px;
}

.color-dot-small {
    border-radius: 50%;
    transition: all 0.2s ease;
    border: 2px solid #666;
}

.color-dot-small:hover {
    transform: scale(1.1);
    border-color: #111;
}

.color-dot-small.selected {
    border-color: #4f46e5;
    transform: scale(1.15);
    border-width: 3px;
    box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.3);
}

.force-visible {
    display: block !important;
    visibility: visible !important;
}
</style>

<script>
function toggleEntryDetails(card) {
    const details = card.querySelector('.entry-details');
    if (details) details.classList.toggle('hidden');
}

function toggleNoteDetails(card) {
    const details = card.querySelector('.note-details');
    if (details) details.classList.toggle('hidden');
}

function collapseAllEntries() {
    document.querySelectorAll('.entry-details').forEach(d => d.classList.add('hidden'));
}

function collapseAllNotes() {
    document.querySelectorAll('.note-details').forEach(d => d.classList.add('hidden'));
}
    let selectedChildId = null;
    
    function toggleNotesForm() {
        const mobileForm = document.getElementById('notesFormMobile');
        const desktopForm = document.getElementById('notesFormDesktop');
        if (mobileForm) mobileForm.classList.toggle('hidden');
        if (desktopForm) desktopForm.classList.toggle('hidden');
    }
    
        // Modal functions
    function openAddChildModal() {
        document.getElementById('addChildModal').classList.remove('hidden');
    }

    function closeAddChildModal() {
        document.getElementById('addChildModal').classList.add('hidden');
    }

    function openAddEntryModal() {
        document.getElementById('addEntryModal').classList.remove('hidden');
    }

    function closeAddEntryModal() {
        document.getElementById('addEntryModal').classList.add('hidden');
    }

    function openAddNoteModal() {
        document.getElementById('addNoteModal').classList.remove('hidden');
    }

    function closeAddNoteModal() {
        document.getElementById('addNoteModal').classList.add('hidden');
    }

    function openEditChildModal(childId, childData) {
        // Populate the form with child data
        document.getElementById('edit_child_name').value = childData.name;
        document.getElementById('edit_child_birth_date').value = childData.birth_date;
        document.getElementById('edit_child_school').value = childData.school || '';
        document.getElementById('edit_child_year').value = childData.year || '';
        document.getElementById('edit_child_class_name').value = childData.class_name || '';
        document.getElementById('edit_child_colour').value = childData.colour;
        
        // Set the form action to the edit URL
        document.getElementById('editChildForm').action = '/edit_child/' + childId + '/';
        
        // Select the correct color dot
        const colorDots = document.querySelectorAll('#editChildModal .color-dot');
        colorDots.forEach(dot => {
            dot.classList.remove('selected');
            if (dot.getAttribute('data-color') === childData.colour) {
                dot.classList.add('selected');
            }
        });
        
        // Show the modal
        document.getElementById('editChildModal').classList.remove('hidden');
    }

    function closeEditChildModal() {
        document.getElementById('editChildModal').classList.add('hidden');
    }

    function selectEditColorDot(element) {
        // Remove selected class from all dots
        const allDots = document.querySelectorAll('#editChildModal .color-dot');
        allDots.forEach(dot => dot.classList.remove('selected'));
        
        // Add selected class to clicked dot
        element.classList.add('selected');
        
        // Update hidden input
        document.getElementById('edit_child_colour').value = element.getAttribute('data-color');
    }

    function deleteChild() {
        if (confirm('Are you sure you want to delete this child? This action cannot be undone.')) {
            const form = document.getElementById('editChildForm');
            const deleteForm = document.createElement('form');
            deleteForm.method = 'post';
            deleteForm.action = form.action.replace('/edit_child/', '/delete_child/');
            
            const csrfToken = document.createElement('input');
            csrfToken.type = 'hidden';
            csrfToken.name = 'csrfmiddlewaretoken';
            csrfToken.value = document.querySelector('[name=csrfmiddlewaretoken]').value;
            
            deleteForm.appendChild(csrfToken);
            document.body.appendChild(deleteForm);
            deleteForm.submit();
        }
    }

    function deleteChildConfirm(childId, childName) {
        if (confirm(`Are you sure you want to delete ${childName}? This action cannot be undone and will also delete all associated entries and notes.`)) {
            const deleteForm = document.createElement('form');
            deleteForm.method = 'post';
            deleteForm.action = '/delete_child/' + childId + '/';
            
            const csrfToken = document.createElement('input');
            csrfToken.type = 'hidden';
            csrfToken.name = 'csrfmiddlewaretoken';
            csrfToken.value = document.querySelector('[name=csrfmiddlewaretoken]').value;
            
            deleteForm.appendChild(csrfToken);
            document.body.appendChild(deleteForm);
            deleteForm.submit();
        }
    }

    function deleteEntryConfirm(entryId, entryTitle) {
        if (confirm(`Are you sure you want to delete "${entryTitle}"? This action cannot be undone.`)) {
            const deleteForm = document.createElement('form');
            deleteForm.method = 'post';
            deleteForm.action = '/delete_entry/' + entryId + '/';
            
            const csrfToken = document.createElement('input');
            csrfToken.type = 'hidden';
            csrfToken.name = 'csrfmiddlewaretoken';
            csrfToken.value = document.querySelector('[name=csrfmiddlewaretoken]').value;
            
            deleteForm.appendChild(csrfToken);
            document.body.appendChild(deleteForm);
            deleteForm.submit();
        }
    }

    function deleteNoteConfirm(noteId, noteTitle) {
        if (confirm(`Are you sure you want to delete "${noteTitle}"? This action cannot be undone.`)) {
            const deleteForm = document.createElement('form');
            deleteForm.method = 'post';
            deleteForm.action = '/delete_note/' + noteId + '/';
            
            const csrfToken = document.createElement('input');
            csrfToken.type = 'hidden';
            csrfToken.name = 'csrfmiddlewaretoken';
            csrfToken.value = document.querySelector('[name=csrfmiddlewaretoken]').value;
            
            deleteForm.appendChild(csrfToken);
            document.body.appendChild(deleteForm);
            deleteForm.submit();
        }
    }

    // Close modals when clicking outside or pressing escape
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            closeAddChildModal();
            closeAddEntryModal();
            closeAddNoteModal();
            closeEditChildModal();
            closeEditEntryModal();
            closeEditNoteModal();
        }
    });

    function toggleChildForm(isMobile = false) {
        const desktopForm = document.getElementById('childFormDesktop');
        const mobileForm = document.getElementById('childFormMobile');
        if (isMobile && mobileForm) mobileForm.classList.toggle('hidden');
        if (!isMobile && desktopForm) desktopForm.classList.toggle('hidden');
    }

    function selectChildColor(colorDot, childId) {
        // Remove selected class from all color dots for this child
        const parentForm = colorDot.closest('form');
        if (parentForm) {
            parentForm.querySelectorAll('.color-dot-small').forEach(dot => {
                dot.classList.remove('selected');
                dot.style.borderWidth = '1px';
                dot.style.borderColor = '#666';
            });
        }
        
        // Add selected class to clicked dot
        colorDot.classList.add('selected');
        colorDot.style.borderWidth = '3px';
        colorDot.style.borderColor = '#4F46E5';
        
        // Update hidden input
        const colorInput = document.getElementById(`childColor${childId}`);
        if (colorInput) {
            colorInput.value = colorDot.dataset.color;
        }
    }

    function toggleEntryForm(isMobile = false) {
        const mobileForm = document.getElementById('entryFormMobile');
        const desktopForm = document.getElementById('entryFormDesktop');
        if (mobileForm) mobileForm.classList.toggle('hidden');
        if (desktopForm) desktopForm.classList.toggle('hidden');
        
        // Update child field visibility and selection based on current state
        updateChildFieldsInForms();
    }
    
    function updateChildFieldsInForms() {
        // Always show child dropdown fields and auto-select for both entry and notes forms
        const childSelects = document.querySelectorAll('select[name="child"]');
        childSelects.forEach(select => {
            if (selectedChildId && selectedChildId !== 'all') {
                select.value = selectedChildId;
            } else {
                select.selectedIndex = 0;
            }
        });
    }
    
    function selectChild(childId, childName) {
        selectedChildId = childId;
        
        // Update child selection in forms
        const childSelects = document.querySelectorAll('select[name="child"]');
        childSelects.forEach(select => {
            select.value = childId;
        });
        
        // Update child fields in forms based on selection
        updateChildFieldsInForms();
        
        // Filter entries and notes to show only selected child's content
        filterContentByChild(childId);
        
        // Update UI to show selected child
        updateSelectedChildUI(childId, childName);
    }

    // Initialize color selection when page loads
    document.addEventListener('DOMContentLoaded', function() {
        // Set up color selection for each child edit form
        const childCards = document.querySelectorAll('.child-card');
        childCards.forEach(card => {
            const childId = card.dataset.childId;
            const colorInput = document.getElementById(`childColor${childId}`);
            if (colorInput) {
                const currentColor = colorInput.value;
                const colorDot = card.querySelector(`[data-color="${currentColor}"]`);
                if (colorDot) {
                    colorDot.classList.add('selected');
                    colorDot.style.borderWidth = '3px';
                    colorDot.style.borderColor = '#4F46E5';
                }
            }
        });
        
        // Initialize child fields in forms on page load
        updateChildFieldsInForms();
    });

    function toggleChildEdit(childId) {
        // Find forms for both mobile and desktop with correct IDs
        const mobileForm = document.getElementById(`childEdit${childId}Mobile`);
        const desktopForm = document.getElementById(`childEdit${childId}Desktop`);
        
        // Get child name for selection
        const childCard = document.querySelector(`[data-child-id="${childId}"]`);
        const childNameElement = childCard ? childCard.querySelector('h3') : null;
        const childName = childNameElement ? childNameElement.textContent.trim() : `Child ${childId}`;
        
        // Select the child first (filter entries and update UI)
        selectChild(childId, childName);
        
        // Toggle the forms exactly like other forms
        if (mobileForm) mobileForm.classList.toggle('hidden');
        if (desktopForm) desktopForm.classList.toggle('hidden');
    }
    
    // Filter only entries and notes, NOT child cards
    function filterEntriesOnly(childId) {
        const entries = document.querySelectorAll('[data-child-id]');
        entries.forEach(entry => {
            // Skip child cards - only filter actual content
            if (!entry.classList.contains('child-card')) {
                if (entry.dataset.childId == childId) {
                    entry.style.display = 'block';
                } else {
                    entry.style.display = 'none';
                }
            }
        });
    }
    
    // Update only headers, not child card states
    function updateHeadersOnly(childId, childName) {
        const headers = document.querySelectorAll('.child-header-text');
        headers.forEach(header => {
            header.textContent = childName + "'s Tasks & Events";
        });
        
        const noteHeaders = document.querySelectorAll('.notes-header-text');
        noteHeaders.forEach(header => {
            header.textContent = childName + "'s Notes";
        });
    }
    
    function showAllChildren() {
        selectedChildId = null;
        
        // Hide all edit forms first (close any open child edit forms)
        const allEditFormsMobile = document.querySelectorAll('[id^="childEdit"][id$="Mobile"]');
        const allEditFormsDesktop = document.querySelectorAll('[id^="childEdit"][id$="Desktop"]');
        allEditFormsMobile.forEach(form => form.classList.add('hidden'));
        allEditFormsDesktop.forEach(form => form.classList.add('hidden'));
        
        // Show all content entries (but child cards should always be visible)
        const entries = document.querySelectorAll('[data-child-id]');
        entries.forEach(entry => {
            entry.style.display = 'block';
        });
        
        // Reset child selection in forms
        const childSelects = document.querySelectorAll('select[name="child"]');
        childSelects.forEach(select => {
            select.selectedIndex = 0;
        });
        
        // Update child fields in forms to show dropdowns
        updateChildFieldsInForms();
        
        // Reset UI
        updateSelectedChildUI(null, 'All Children');
    }
    
    function filterContentByChild(childId) {
        const entries = document.querySelectorAll('[data-child-id]');
        entries.forEach(entry => {
            // Skip child cards - only filter actual content entries
            if (!entry.classList.contains('child-card')) {
                if (entry.dataset.childId == childId) {
                    entry.style.display = 'block';
                } else {
                    entry.style.display = 'none';
                }
            }
        });
    }
    
    function updateSelectedChildUI(childId, childName) {
        // Update header text
        const headers = document.querySelectorAll('.child-header-text');
        headers.forEach(header => {
            header.textContent = childName + (childId ? "'s Tasks & Events" : " Overview");
        });
        
        const noteHeaders = document.querySelectorAll('.notes-header-text');
        noteHeaders.forEach(header => {
            header.textContent = childId ? childName + "'s Notes" : "All Notes";
        });
        
        // Update child cards active state
        const childCards = document.querySelectorAll('.child-card');
        childCards.forEach(card => {
            if (card.dataset.childId == childId) {
                card.classList.add('border-primary', 'bg-blue-50');
                card.classList.remove('border-gray-300');
            } else {
                card.classList.remove('border-primary', 'bg-blue-50');
                card.classList.add('border-gray-300');
            }
        });
    }

    // Edit Entry Modal functions
    function openEditEntryModal(entryId, childId, category, title, content, date) {
        const modal = document.getElementById('editEntryModal');
        const form = document.getElementById('editEntryForm');
        
        // Populate form fields
        document.getElementById('edit_entry_child').value = childId;
        document.getElementById('edit_entry_category').value = category;
        document.getElementById('edit_entry_title').value = title;
        document.getElementById('edit_entry_content').value = content;
        document.getElementById('edit_entry_date').value = date;
        
        // Set form action
        form.action = '/edit_entry/' + entryId + '/';
        
        // Show modal
        modal.classList.remove('hidden');
    }

    function closeEditEntryModal() {
        const modal = document.getElementById('editEntryModal');
        modal.classList.add('hidden');
    }

    function deleteEntry() {
        const form = document.getElementById('editEntryForm');
        const entryTitle = document.getElementById('edit_entry_title').value;
        
        if (confirm(`Are you sure you want to delete "${entryTitle}"? This action cannot be undone.`)) {
            const deleteForm = document.createElement('form');
            deleteForm.method = 'post';
            deleteForm.action = form.action.replace('/edit_entry/', '/delete_entry/');
            
            const csrfToken = document.createElement('input');
            csrfToken.type = 'hidden';
            csrfToken.name = 'csrfmiddlewaretoken';
            csrfToken.value = document.querySelector('[name=csrfmiddlewaretoken]').value;
            
            deleteForm.appendChild(csrfToken);
            document.body.appendChild(deleteForm);
            deleteForm.submit();
        }
    }

    // Edit Note Modal functions
    function openEditNoteModal(noteId, childId, title, content, date) {
        const modal = document.getElementById('editNoteModal');
        const form = document.getElementById('editNoteForm');
        
        // Populate form fields
        document.getElementById('edit_note_child').value = childId;
        document.getElementById('edit_note_title').value = title;
        document.getElementById('edit_note_content').value = content;
        document.getElementById('edit_note_date').value = date;
        
        // Set form action
        form.action = '/edit_note/' + noteId + '/';
        
        // Show modal
        modal.classList.remove('hidden');
    }

    function closeEditNoteModal() {
        const modal = document.getElementById('editNoteModal');
        modal.classList.add('hidden');
    }

    function deleteNote() {
        const form = document.getElementById('editNoteForm');
        const noteTitle = document.getElementById('edit_note_title').value;
        
        if (confirm(`Are you sure you want to delete "${noteTitle}"? This action cannot be undone.`)) {
            const deleteForm = document.createElement('form');
            deleteForm.method = 'post';
            deleteForm.action = form.action.replace('/edit_note/', '/delete_note/');
            
            const csrfToken = document.createElement('input');
            csrfToken.type = 'hidden';
            csrfToken.name = 'csrfmiddlewaretoken';
            csrfToken.value = document.querySelector('[name=csrfmiddlewaretoken]').value;
            
            deleteForm.appendChild(csrfToken);
            document.body.appendChild(deleteForm);
            deleteForm.submit();
        }
    }
</script>
{% endblock %}

{% block content %}
<!-- Modal Overlays -->
<!-- Add Child Modal -->
<div id="addChildModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center" onclick="closeAddChildModal()">
    <div class="bg-white border-2 border-secondary w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
        <div class="border-b-2 border-secondary bg-purple-50 px-4 py-3">
            <div class="flex items-center justify-between">
                <h2 class="text-lg font-medium text-gray-900">Add New Child</h2>
                <button onclick="closeAddChildModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="p-4">
            <form method="post" class="space-y-4">
                {% csrf_token %}
                <input type="hidden" name="add_child" value="1">
                
                <div>
                    <label for="{{ child_form.name.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Name</label>
                    {{ child_form.name }}
                </div>
                
                <div>
                    <label for="{{ child_form.birth_date.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">{{ child_form.birth_date.label }}</label>
                    {{ child_form.birth_date }}
                    {% if child_form.birth_date.help_text %}
                        <p class="text-xs text-gray-500 mt-1">{{ child_form.birth_date.help_text }}</p>
                    {% endif %}
                </div>
                
                <div>
                    <label for="{{ child_form.school.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">School</label>
                    {{ child_form.school }}
                </div>
                
                <div>
                    <label for="{{ child_form.year.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Year</label>
                    {{ child_form.year }}
                </div>
                
                <div>
                    <label for="{{ child_form.class_name.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Class</label>
                    {{ child_form.class_name }}
                </div>
                
                <div>
                    <label for="{{ child_form.colour.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Colour</label>
                    {{ child_form.colour }}
                    
                    <!-- Custom color grid -->
                    <div class="color-grid-widget mt-2" data-target="{{ child_form.colour.id_for_label }}">
                        <div class="color-dots-grid grid grid-cols-5 gap-2">
                            <div class="color-dot selected w-8 h-8 border-2 cursor-pointer" 
                                 data-color="#FF6B6B"
                                 onclick="selectColorDot(this, '{{ child_form.colour.id_for_label }}')"
                                 style="background-color: #FF6B6B;"
                                 title="Coral Red">
                            </div>
                            <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                                 data-color="#4ECDC4"
                                 onclick="selectColorDot(this, '{{ child_form.colour.id_for_label }}')"
                                 style="background-color: #4ECDC4;"
                                 title="Turquoise">
                            </div>
                            <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                                 data-color="#0D6A80"
                                 onclick="selectColorDot(this, '{{ child_form.colour.id_for_label }}')"
                                 style="background-color: #0D6A80;"
                                 title="Sky Blue">
                            </div>
                            <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                                 data-color="#96CEB4"
                                 onclick="selectColorDot(this, '{{ child_form.colour.id_for_label }}')"
                                 style="background-color: #96CEB4;"
                                 title="Mint Green">
                            </div>
                            <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                                 data-color="#D1D811"
                                 onclick="selectColorDot(this, '{{ child_form.colour.id_for_label }}')"
                                 style="background-color: #D1D811;"
                                 title="Sunny Yellow">
                            </div>
                            <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                                 data-color="#DDA0DD"
                                 onclick="selectColorDot(this, '{{ child_form.colour.id_for_label }}')"
                                 style="background-color: #DDA0DD;"
                                 title="Plum Purple">
                            </div>
                            <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                                 data-color="#AD6A0D"
                                 onclick="selectColorDot(this, '{{ child_form.colour.id_for_label }}')"
                                 style="background-color: #AD6A0D;"
                                 title="Peach Orange">
                            </div>
                            <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                                 data-color="#8516EE"
                                 onclick="selectColorDot(this, '{{ child_form.colour.id_for_label }}')"
                                 style="background-color: #8516EE;"
                                 title="Light Blue">
                            </div>
                            <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                                 data-color="#0CEB0C"
                                 onclick="selectColorDot(this, '{{ child_form.colour.id_for_label }}')"
                                 style="background-color: #0CEB0C;"
                                 title="Pale Green">
                            </div>
                            <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                                 data-color="#BE12E0"
                                 onclick="selectColorDot(this, '{{ child_form.colour.id_for_label }}')"
                                 style="background-color: #BE12E0;"
                                 title="Bright Pink">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex gap-2 pt-2">
                    <button type="submit" class="bg-secondary hover:bg-purple-700 text-white font-medium py-2 px-4 border-2 border-secondary transition-all duration-200 tracking-wide">
                        Add Child
                    </button>
                    <button type="button" onclick="closeAddChildModal()" class="bg-gray-300 hover:bg-gray-400 text-gray-700 font-medium py-2 px-4 border-2 border-gray-300 transition-all duration-200 tracking-wide">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Add Entry Modal -->
<div id="addEntryModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center" onclick="closeAddEntryModal()">
    <div class="bg-white border-2 border-primary w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
        <div class="border-b-2 border-primary bg-gray-50 px-4 py-3">
            <div class="flex items-center justify-between">
                <h2 class="text-lg font-medium text-gray-900">Add New Entry</h2>
                <button onclick="closeAddEntryModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="p-4">
            <form method="post" class="space-y-4">
                {% csrf_token %}
                <input type="hidden" name="add_entry" value="1">
                <input type="hidden" id="selectedChildInputModal" name="selected_child" value="">
                
                <div>
                    <label for="{{ form.child.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Child</label>
                    {{ form.child }}
                </div>
                
                <div>
                    <label for="{{ form.title.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                    {{ form.title }}
                </div>
                
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label for="{{ form.entry_type.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Type</label>
                        {{ form.entry_type }}
                    </div>
                    <div>
                        <label for="{{ form.category.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                        {{ form.category }}
                    </div>
                </div>
                
                <div>
                    <label for="{{ form.description.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                    {{ form.description }}
                </div>
                
                <div class="flex gap-2 pt-2">
                    <button type="submit" class="bg-primary hover:bg-secondary text-white font-medium py-2 px-4 border-2 border-primary transition-all duration-200 tracking-wide">
                        Save Entry
                    </button>
                    <button type="button" onclick="closeAddEntryModal()" class="bg-gray-300 hover:bg-gray-400 text-gray-700 font-medium py-2 px-4 border-2 border-gray-300 transition-all duration-200 tracking-wide">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Add Note Modal -->
<div id="addNoteModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center" onclick="closeAddNoteModal()">
    <div class="bg-white border-2 border-green-600 w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
        <div class="border-b-2 border-green-600 bg-green-50 px-4 py-3">
            <div class="flex items-center justify-between">
                <h2 class="text-lg font-medium text-green-700">Add New Note</h2>
                <button onclick="closeAddNoteModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="p-4">
            <form method="post" class="space-y-4">
                {% csrf_token %}
                <input type="hidden" name="add_note" value="1">
                
                <div>
                    <label for="{{ note_form.child.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Child</label>
                    {{ note_form.child }}
                </div>
                
                <div>
                    <label for="{{ note_form.title.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                    {{ note_form.title }}
                </div>
                
                <div>
                    <label for="{{ note_form.category.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Category (Optional)</label>
                    {{ note_form.category }}
                </div>
                
                <div>
                    <label for="{{ note_form.description.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Note</label>
                    {{ note_form.description }}
                </div>
                
                {{ note_form.entry_type }}
                
                <div class="flex gap-2 pt-2">
                    <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 border-2 border-green-600 transition-all duration-200 tracking-wide">
                        Save Note
                    </button>
                    <button type="button" onclick="closeAddNoteModal()" class="bg-gray-300 hover:bg-gray-400 text-gray-700 font-medium py-2 px-4 border-2 border-gray-300 transition-all duration-200 tracking-wide">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Child Modal -->
<div id="editChildModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center" onclick="closeEditChildModal()">
    <div class="bg-white border-2 border-secondary w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
        <div class="border-b-2 border-secondary bg-purple-50 px-4 py-3">
            <div class="flex items-center justify-between">
                <h2 class="text-lg font-medium text-gray-900">Edit Child</h2>
                <button onclick="closeEditChildModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        
        <div class="p-4">
            <form id="editChildForm" method="post" class="space-y-4">
                {% csrf_token %}
                
                <div>
                    <label for="edit_child_name" class="block text-sm font-medium text-gray-700 mb-1">Name</label>
                    <input type="text" id="edit_child_name" name="name" 
                           class="w-full px-3 py-2 border-2 border-gray-300 focus:border-secondary focus:outline-none">
                </div>
                
                <div>
                    <label for="edit_child_birth_date" class="block text-sm font-medium text-gray-700 mb-1">Date of Birth</label>
                    <input type="date" id="edit_child_birth_date" name="birth_date" 
                           class="w-full px-3 py-2 border-2 border-gray-300 focus:border-secondary focus:outline-none">
                </div>
                
                <div>
                    <label for="edit_child_school" class="block text-sm font-medium text-gray-700 mb-1">School</label>
                    <input type="text" id="edit_child_school" name="school" 
                           class="w-full px-3 py-2 border-2 border-gray-300 focus:border-secondary focus:outline-none">
                </div>
                
                <div>
                    <label for="edit_child_year" class="block text-sm font-medium text-gray-700 mb-1">Year</label>
                    <input type="text" id="edit_child_year" name="year" 
                           class="w-full px-3 py-2 border-2 border-gray-300 focus:border-secondary focus:outline-none">
                </div>
                
                <div>
                    <label for="edit_child_class_name" class="block text-sm font-medium text-gray-700 mb-1">Class</label>
                    <input type="text" id="edit_child_class_name" name="class_name" 
                           class="w-full px-3 py-2 border-2 border-gray-300 focus:border-secondary focus:outline-none">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Color</label>
                    <input type="hidden" id="edit_child_colour" name="colour">
                    <div class="grid grid-cols-5 gap-2">
                        <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                             data-color="#FF6B6B"
                             onclick="selectEditColorDot(this)"
                             style="background-color: #FF6B6B;"
                             title="Coral Red">
                        </div>
                        <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                             data-color="#4ECDC4"
                             onclick="selectEditColorDot(this)"
                             style="background-color: #4ECDC4;"
                             title="Turquoise">
                        </div>
                        <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                             data-color="#0D6A80"
                             onclick="selectEditColorDot(this)"
                             style="background-color: #0D6A80;"
                             title="Sky Blue">
                        </div>
                        <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                             data-color="#96CEB4"
                             onclick="selectEditColorDot(this)"
                             style="background-color: #96CEB4;"
                             title="Mint Green">
                        </div>
                        <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                             data-color="#D1D811"
                             onclick="selectEditColorDot(this)"
                             style="background-color: #D1D811;"
                             title="Sunny Yellow">
                        </div>
                        <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                             data-color="#DDA0DD"
                             onclick="selectEditColorDot(this)"
                             style="background-color: #DDA0DD;"
                             title="Plum Purple">
                        </div>
                        <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                             data-color="#AD6A0D"
                             onclick="selectEditColorDot(this)"
                             style="background-color: #AD6A0D;"
                             title="Peach Orange">
                        </div>
                        <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                             data-color="#8516EE"
                             onclick="selectEditColorDot(this)"
                             style="background-color: #8516EE;"
                             title="Light Blue">
                        </div>
                        <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                             data-color="#0CEB0C"
                             onclick="selectEditColorDot(this)"
                             style="background-color: #0CEB0C;"
                             title="Pale Green">
                        </div>
                        <div class="color-dot w-8 h-8 border-2 cursor-pointer" 
                             data-color="#BE12E0"
                             onclick="selectEditColorDot(this)"
                             style="background-color: #BE12E0;"
                             title="Bright Pink">
                        </div>
                    </div>
                </div>
                
                <div class="flex gap-2 pt-2">
                    <button type="submit" class="bg-secondary hover:bg-purple-700 text-white font-medium py-2 px-4 border-2 border-secondary transition-all duration-200 tracking-wide">
                        Save Changes
                    </button>
                    <button type="button" onclick="closeEditChildModal()" class="bg-gray-300 hover:bg-gray-400 text-gray-700 font-medium py-2 px-4 border-2 border-gray-300 transition-all duration-200 tracking-wide">
                        Cancel
                    </button>
                    <button type="button" onclick="deleteChild()" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 border-2 border-red-600 transition-all duration-200 tracking-wide ml-auto">
                        Delete
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Entry Modal -->
<div id="editEntryModal" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm hidden z-50 flex items-center justify-center" onclick="closeEditEntryModal()">
    <div class="bg-white p-8 rounded-lg shadow-xl max-w-lg w-full mx-4 border-2 border-gray-300" onclick="event.stopPropagation()">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-gray-800">Edit Entry</h2>
            <button onclick="closeEditEntryModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
        </div>
        <div class="max-h-96 overflow-y-auto">
            <form id="editEntryForm" method="post">
                {% csrf_token %}
                
                <div class="mb-4">
                    <label for="edit_entry_child" class="block text-sm font-medium text-gray-700 mb-2">Child</label>
                    <select id="edit_entry_child" name="child" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        {% for child in children %}
                        <option value="{{ child.id }}">{{ child.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="mb-4">
                    <label for="edit_entry_category" class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                    <select id="edit_entry_category" name="category" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        <option value="health">Health</option>
                        <option value="school">School</option>
                        <option value="activities">Activities</option>
                        <option value="social">Social</option>
                        <option value="behavior">Behavior</option>
                        <option value="milestone">Milestone</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <div class="mb-4">
                    <label for="edit_entry_title" class="block text-sm font-medium text-gray-700 mb-2">Title</label>
                    <input type="text" id="edit_entry_title" name="title" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" required>
                </div>
                
                <div class="mb-4">
                    <label for="edit_entry_content" class="block text-sm font-medium text-gray-700 mb-2">Content</label>
                    <textarea id="edit_entry_content" name="content" rows="4" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" required></textarea>
                </div>
                
                <div class="mb-4">
                    <label for="edit_entry_date" class="block text-sm font-medium text-gray-700 mb-2">Date</label>
                    <input type="date" id="edit_entry_date" name="date" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" required>
                </div>
                
                <div class="flex gap-2 pt-2">
                    <button type="submit" class="bg-secondary hover:bg-purple-700 text-white font-medium py-2 px-4 border-2 border-secondary transition-all duration-200 tracking-wide">
                        Save Changes
                    </button>
                    <button type="button" onclick="closeEditEntryModal()" class="bg-gray-300 hover:bg-gray-400 text-gray-700 font-medium py-2 px-4 border-2 border-gray-300 transition-all duration-200 tracking-wide">
                        Cancel
                    </button>
                    <button type="button" onclick="deleteEntry()" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 border-2 border-red-600 transition-all duration-200 tracking-wide ml-auto">
                        Delete
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Note Modal -->
<div id="editNoteModal" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm hidden z-50 flex items-center justify-center" onclick="closeEditNoteModal()">
    <div class="bg-white p-8 rounded-lg shadow-xl max-w-lg w-full mx-4 border-2 border-gray-300" onclick="event.stopPropagation()">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-gray-800">Edit Note</h2>
            <button onclick="closeEditNoteModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
        </div>
        <div class="max-h-96 overflow-y-auto">
            <form id="editNoteForm" method="post">
                {% csrf_token %}
                
                <div class="mb-4">
                    <label for="edit_note_child" class="block text-sm font-medium text-gray-700 mb-2">Child</label>
                    <select id="edit_note_child" name="child" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        {% for child in children %}
                        <option value="{{ child.id }}">{{ child.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="mb-4">
                    <label for="edit_note_title" class="block text-sm font-medium text-gray-700 mb-2">Title</label>
                    <input type="text" id="edit_note_title" name="title" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" required>
                </div>
                
                <div class="mb-4">
                    <label for="edit_note_content" class="block text-sm font-medium text-gray-700 mb-2">Content</label>
                    <textarea id="edit_note_content" name="content" rows="4" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" required></textarea>
                </div>
                
                <div class="mb-4">
                    <label for="edit_note_date" class="block text-sm font-medium text-gray-700 mb-2">Date</label>
                    <input type="date" id="edit_note_date" name="date" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" required>
                </div>
                
                <div class="flex gap-2 pt-2">
                    <button type="submit" class="bg-secondary hover:bg-purple-700 text-white font-medium py-2 px-4 border-2 border-secondary transition-all duration-200 tracking-wide">
                        Save Changes
                    </button>
                    <button type="button" onclick="closeEditNoteModal()" class="bg-gray-300 hover:bg-gray-400 text-gray-700 font-medium py-2 px-4 border-2 border-gray-300 transition-all duration-200 tracking-wide">
                        Cancel
                    </button>
                    <button type="button" onclick="deleteNote()" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 border-2 border-red-600 transition-all duration-200 tracking-wide ml-auto">
                        Delete
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="overflow-hidden h-screen flex flex-col" style="height: calc(100vh - 80px); min-height: 0;">
    <!-- Message System -->
    {% if messages %}
    <div class="flex-shrink-0 px-3 sm:px-6 pt-4 pb-2">
        {% for message in messages %}
        {# Filter out unwanted allauth messages #}
        {% if "Successfully signed in" not in message|stringformat:"s" and "You have signed out" not in message|stringformat:"s" %}
        <div class="border-l-4 p-2 sm:p-4 mb-2 text-sm sm:text-base {% if message.tags == 'success' %}bg-green-50 border-green-500 text-green-800{% elif message.tags == 'error' %}bg-red-50 border-red-500 text-red-800{% else %}bg-blue-50 border-blue-500 text-blue-800{% endif %}">
            <div class="flex items-center">
                <span class="font-medium">{{ message }}</span>
            </div>
        </div>
        {% endif %}
        {% endfor %}
    </div>
    {% endif %}

    <!-- Main Content with Child Page Layout -->
    <div class="px-3 sm:px-6 py-6 flex flex-col h-full" style="height: calc(100vh - 140px); min-height: 0;">
        
        {% if children_count == 0 %}
            <!-- Empty State: No Children -->
            {% include 'widgets/dashboard_empty.html' %}
        {% else %}
            <!-- Unified Dashboard: Child Page Layout with Multiple Children Support -->
            
            <!-- Mobile Layout: Horizontal Swipe -->
            <div class="md:hidden flex flex-col h-full min-h-0">
                <!-- Children Header (Fixed) -->
                <div class="bg-white border-2 border-primary shadow-lg mb-4">
                    <div class="border-b-2 border-primary bg-gray-50 px-3 py-2 sm:px-6 sm:py-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <h1 class="text-lg sm:text-xl md:text-2xl lg:text-3xl font-normal text-gray-900 tracking-wide child-header-text">Family Dashboard</h1>
                                <p class="text-gray-600 font-medium text-xs">{{ children_count }} children, {{ total_entries }} total entries</p>
                            </div>
                            <div class="flex items-center gap-2">
                                <button onclick="openAddChildModal()" class="bg-secondary hover:bg-purple-700 text-white p-2 border-2 border-secondary transition-all duration-200 hover:shadow-lg">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button onclick="showAllChildren()" class="bg-secondary hover:bg-purple-700 text-white font-normal px-3 py-2 border-2 border-secondary transition-all duration-200 tracking-wide text-xs">
                                    All
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Children Cards Horizontal Scroll -->
                    <div class="p-3 overflow-x-auto" style="overflow-y: visible; max-height: 120px;">
                        <div class="flex gap-3" style="width: max-content; overflow: visible;">
                            {% for child in children %}
                            <div class="child-card border-2 border-gray-300 bg-white hover:bg-gray-50 transition-all duration-200 flex-shrink-0 w-32" 
                                 data-child-id="{{ child.id }}">
                                <div class="p-3 relative">
                                    <div class="absolute top-1 right-1 flex gap-1">
                                        <button onclick="openEditChildModal('{{ child.id }}', {
                                            name: '{{ child.name|escapejs }}',
                                            birth_date: '{{ child.birth_date|date:'Y-m-d' }}',
                                            school: '{{ child.school|default_if_none:''|escapejs }}',
                                            year: '{{ child.year|default_if_none:''|escapejs }}',
                                            class_name: '{{ child.class_name|default_if_none:''|escapejs }}',
                                            colour: '{{ child.colour }}'
                                        })" class="text-gray-400 hover:text-primary transition-colors duration-200 text-xs">
                                            <i class="fas fa-pencil-alt"></i>
                                        </button>
                                        <button onclick="deleteChildConfirm('{{ child.id }}', '{{ child.name|escapejs }}')" class="text-red-400 hover:text-red-600 transition-colors duration-200 text-xs">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                    <div class="text-center">
                                        <div class="w-8 h-8 mx-auto border-2 border-primary flex items-center justify-center text-white font-normal text-sm tracking-wide mb-2" 
                                             style="background-color: {{ child.colour }};" onclick="selectChild('{{ child.id }}')">
                                            {{ child.name|first|upper }}
                                        </div>
                                        <h3 class="text-xs font-medium text-gray-900">{{ child.name }}</h3>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                <!-- Horizontal Swipe Container -->
                <div class="overflow-x-auto flex flex-col h-full" style="height: calc(100vh - 200px); min-height: 0;">
                    <div class="flex space-x-4 h-full min-h-0" style="width: 200%;">
                        <!-- Timeline Section (50% of container width) -->
                        <div class="w-1/2 bg-white border-2 border-primary shadow-lg h-full flex flex-col min-h-0">
                            <div class="border-b-2 border-primary bg-gray-50 px-3 py-2 sm:px-6 sm:py-4 flex-shrink-0 min-h-0">
                                <div class="flex items-center justify-between">
                                    <h3 class="text-lg sm:text-xl font-normal text-gray-900 tracking-wide child-header-text">Tasks & Events</h3>
                                    <div class="flex items-center gap-2">
                                        <nav class="flex gap-2">
                                            <a href="?type=" class="py-2 px-4 border-2 font-normal text-xs tracking-wide transition-all duration-200 {% if not request.GET.type %}bg-primary text-white border-primary{% else %}bg-white text-gray-700 border-gray-300 hover:border-primary hover:text-primary{% endif %}">
                                                All
                                            </a>
                                            <a href="?type=task" class="py-2 px-4 border-2 font-normal text-xs tracking-wide transition-all duration-200 {% if request.GET.type == 'task' %}bg-amber-600 text-white border-amber-600{% else %}bg-white text-gray-700 border-gray-300 hover:border-amber-600 hover:text-amber-600{% endif %}">
                                                Tasks
                                            </a>
                                            <a href="?type=event" class="py-2 px-4 border-2 font-normal text-xs tracking-wide transition-all duration-200 {% if request.GET.type == 'event' %}bg-violet-600 text-white border-violet-600{% else %}bg-white text-gray-700 border-gray-300 hover:border-violet-600 hover:text-violet-600{% endif %}">
                                                Events
                                            </a>
                                        </nav>
                                        <div class="border-l-2 border-primary pl-3 flex items-center justify-center gap-2">
                                            <button onclick="openAddEntryModal()" class="bg-primary hover:bg-secondary text-white font-normal px-3 py-2 border-2 border-primary transition-all duration-200 tracking-wide text-xs hover:shadow-lg flex items-center justify-center" title="Add Entry">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                            <button onclick="collapseAllEntries()" class="bg-gray-200 hover:bg-primary text-gray-700 hover:text-white font-normal px-3 py-2 border-2 border-primary transition-all duration-200 tracking-wide text-xs hover:shadow-lg flex items-center justify-center" title="Collapse All Entries">
                                                <i class="fas fa-compress-alt"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Entry Form -->
                            <div id="entryFormMobile" class="hidden border-b-2 border-primary bg-gray-25 p-2 rounded-none" style="border-radius: 0;">
                                <form method="post" class="space-y-2">
                                    {% csrf_token %}
                                    <input type="hidden" name="add_entry" value="1">
                                    <input type="hidden" id="selectedChildInput" name="selected_child" value="">
                                    
                                    <!-- Row 1: Child (conditionally shown) and Title -->
                                    <div class="grid grid-cols-2 gap-2">
                                        <div id="childFieldMobile" class="child-field">
                                            <label for="{{ form.child.id_for_label }}" class="block text-xs font-medium text-gray-700 mb-1">Child</label>
                                            {{ form.child }}
                                        </div>
                                        <div>
                                            <label for="{{ form.title.id_for_label }}" class="block text-xs font-medium text-gray-700 mb-1">Title</label>
                                            {{ form.title }}
                                        </div>
                                    </div>
                                    
                                    <!-- Row 2: Type and Category -->
                                    <div class="grid grid-cols-2 gap-2">
                                        <div>
                                            <label for="{{ form.entry_type.id_for_label }}" class="block text-xs font-medium text-gray-700 mb-1">Type</label>
                                            {{ form.entry_type }}
                                        </div>
                                        <div>
                                            <label for="{{ form.category.id_for_label }}" class="block text-xs font-medium text-gray-700 mb-1">Category</label>
                                            {{ form.category }}
                                        </div>
                                    </div>
                                    
                                    <!-- Row 3: Description (full width) -->
                                    <div>
                                        <label for="{{ form.description.id_for_label }}" class="block text-xs font-medium text-gray-700 mb-1">Description</label>
                                        {{ form.description }}
                                    </div>
                                    
                                    <div class="flex gap-1 pt-1">
                                        <button type="submit" class="bg-primary hover:bg-secondary text-white font-normal py-1 px-2 border-2 border-primary transition-all duration-200 tracking-wide text-xs rounded-none" style="border-radius: 0;">
                                            Save Entry
                                        </button>
                                        <button type="button" onclick="openAddEntryModal()" class="bg-gray-300 hover:bg-gray-400 text-gray-700 font-normal py-1 px-2 border-2 border-gray-300 transition-all duration-200 tracking-wide text-xs rounded-none" style="border-radius: 0;">
                                            Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                            
                            <!-- Timeline Content -->
                            <div class="p-3 overflow-y-auto flex-1">
                                {% if active_entries %}
                                    <div class="space-y-2 flex-1 overflow-y-auto min-h-0" style="height: 0;">
                                        {% for entry in active_entries %}
                                            <div class="{% if entry.entry_type == 'task' %}bg-amber-50 border-l-4 border-amber-600{% elif entry.entry_type == 'event' %}bg-violet-50 border-l-4 border-violet-600{% endif %} p-3 hover:bg-opacity-80 transition-all duration-200" 
                                                 data-child-id="{{ entry.child.id }}">
                                                <div class="flex justify-between items-start">
                                                    <div class="flex-1 overflow-y-auto" style="max-height: 40vh;">
                                                        <h4 class="font-medium text-gray-900 text-sm">{{ entry.title }}</h4>
                                                        <p class="text-gray-600 text-xs mt-1">{{ entry.description|truncatewords:10 }}</p>
                                                        <div class="flex items-center gap-2 mt-2 text-xs text-gray-500">
                                                            <span class="bg-gray-100 px-2 py-1 border">{{ entry.child.name }}</span>
                                                            <span>{{ entry.created_at|date:"M d" }}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        {% endfor %}
                                    </div>
                                {% else %}
                                    <div class="text-center py-12">
                                        <div class="w-16 h-16 mx-auto mb-4 bg-gray-100 border-2 border-primary flex items-center justify-center">
                                            <i class="fas fa-calendar-plus text-primary text-xl"></i>
                                        </div>
                                        <p class="text-gray-600 font-normal tracking-wide mb-4">No entries yet</p>
                                        <button onclick="openAddEntryModal()" class="bg-primary hover:bg-secondary text-white font-normal py-1 px-3 border-2 border-primary transition-all duration-200 tracking-wide text-xs">
                                            Add First Entry
                                        </button>
                                    </div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Notes Section (50% of container width) -->
                        <div class="w-1/2 bg-white border-2 border-green-600 shadow-lg h-full flex flex-col">
                            <div class="border-b-2 border-green-600 bg-green-50 px-3 py-2 sm:px-6 sm:py-4 flex-shrink-0">
                                <div class="flex items-center justify-between">
                                    <h3 class="text-lg sm:text-xl font-normal text-green-700 tracking-wide notes-header-text">Notes</h3>
                                    <div class="border-l-2 border-primary pl-3 flex items-center justify-center">
                                        <button onclick="openAddNoteModal()" class="bg-green-600 hover:bg-green-700 text-white font-normal px-3 py-2 border-2 border-green-600 transition-all duration-200 tracking-wide text-xs hover:shadow-lg flex items-center justify-center" title="Add Note">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                        <button onclick="collapseAllNotes()" class="bg-green-200 hover:bg-green-700 text-green-700 hover:text-white font-normal px-3 py-2 border-2 border-green-600 transition-all duration-200 tracking-wide text-xs hover:shadow-lg flex items-center justify-center ml-2" title="Collapse All Notes">
                                            <i class="fas fa-compress-alt"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Notes Form -->
                            <div id="notesFormMobile" class="hidden border-b-2 border-green-600 bg-green-25 p-2 rounded-none" style="border-radius: 0;">
                                <form method="post" class="space-y-2">
                                    {% csrf_token %}
                                    <input type="hidden" name="add_note" value="1">
                                    
                                    <div>
                                        <label for="{{ note_form.child.id_for_label }}" class="block text-xs font-medium text-gray-700 mb-1">Child</label>
                                        {{ note_form.child }}
                                    </div>
                                    
                                    <div>
                                        <label for="{{ note_form.title.id_for_label }}" class="block text-xs font-medium text-gray-700 mb-1">Title</label>
                                        {{ note_form.title }}
                                    </div>
                                    
                                    <div>
                                        <label for="{{ note_form.category.id_for_label }}" class="block text-xs font-medium text-gray-700 mb-1">Category (Optional)</label>
                                        {{ note_form.category }}
                                    </div>
                                    
                                    <div>
                                        <label for="{{ note_form.description.id_for_label }}" class="block text-xs font-medium text-gray-700 mb-1">Note</label>
                                        {{ note_form.description }}
                                    </div>
                                    
                                    {{ note_form.entry_type }}
                                    
                                    <div class="flex gap-1 pt-1">
                                        <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-normal py-1 px-2 border-2 border-green-600 transition-all duration-200 tracking-wide text-xs rounded-none" style="border-radius: 0;">
                                            Save Note
                                        </button>
                                        <button type="button" onclick="openAddNoteModal()" class="bg-gray-300 hover:bg-gray-400 text-gray-700 font-normal py-1 px-2 border-2 border-gray-300 transition-all duration-200 tracking-wide text-xs rounded-none" style="border-radius: 0;">
                                            Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                            
                            <!-- Notes Content -->
                            <div class="p-3 overflow-y-auto flex-1">
                                {% if notes %}
                                    <div class="space-y-2 overflow-y-auto" style="max-height: 40vh; min-height: 0;">
                                        {% for note in notes %}
                                            <div class="bg-green-50 border-l-4 border-green-600 p-3 hover:bg-green-100 transition-all duration-200" 
                                                 data-child-id="{{ note.child.id }}">
                                                <div class="flex justify-between items-start">
                                                    <div class="flex-1 overflow-y-auto" style="max-height: 40vh;">
                                                        <h4 class="font-medium text-gray-900 text-sm">{{ note.title }}</h4>
                                                        <p class="text-gray-600 text-xs mt-1">{{ note.description|truncatewords:15 }}</p>
                                                        <div class="flex items-center gap-2 mt-2 text-xs text-gray-500">
                                                            <span class="bg-gray-100 px-2 py-1 border">{{ note.child.name }}</span>
                                                            <span>{{ note.created_at|date:"M d" }}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        {% endfor %}
                                    </div>
                                {% else %}
                                    <div class="text-center py-12">
                                        <div class="w-16 h-16 mx-auto mb-4 bg-green-100 border-2 border-green-600 flex items-center justify-center">
                                            <i class="fas fa-sticky-note text-green-600 text-xl"></i>
                                        </div>
                                        <p class="text-gray-600 font-normal tracking-wide mb-4">No notes yet</p>
                                        <button onclick="openAddNoteModal()" class="bg-green-600 hover:bg-green-700 text-white font-normal py-1 px-3 border-2 border-green-600 transition-all duration-200 tracking-wide text-xs">
                                            Add First Note
                                        </button>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Desktop Layout: Three Columns (Child Page Structure) -->
            <div class="hidden md:grid md:grid-cols-12 gap-4 lg:gap-6 h-full">
                <!-- Left Column: Children Management (same width as child page) -->
                <div class="md:col-span-2 lg:col-span-2 xl:col-span-2 h-full">
                    <div class="bg-white border-2 border-primary shadow-lg h-full flex flex-col">
                        <div class="border-b-2 border-primary bg-gray-50 px-3 py-2 sm:px-6 sm:py-4">
                            <div class="flex items-center justify-between">
                                <h2 class="text-lg font-normal text-gray-900 tracking-wide">Your Children</h2>
                                <div class="border-l-2 border-primary pl-3 flex items-center justify-center">
                                    <button onclick="openAddChildModal()" class="bg-secondary hover:bg-purple-700 text-white font-normal px-4 py-3 border-2 border-secondary transition-all duration-200 tracking-wide text-sm hover:shadow-lg flex items-center justify-center">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Scrollable content area for child list -->
                        <div class="overflow-y-auto flex-1 min-h-0">
                            
                            <div class="p-4">
                                <div class="space-y-3 flex-1 min-h-0 overflow-y-auto" style="max-height: 40vh; min-height: 0;">
                                    <!-- All Children Button -->
                                    <button onclick="showAllChildren()" 
                                            class="w-full border-2 border-gray-300 bg-white p-3 hover:bg-gray-50 transition-all duration-200 text-left">
                                        <div class="flex items-center">
                                            <div class="w-8 h-8 border-2 border-primary bg-primary flex items-center justify-center text-white font-normal text-sm mr-3">
                                                <i class="fas fa-users"></i>
                                            </div>
                                            <div>
                                                <h3 class="text-sm font-medium text-gray-900">All Children</h3>
                                                <p class="text-xs text-gray-600">{{ children_count }} children, {{ total_entries }} entries</p>
                                            </div>
                                        </div>
                                    </button>
                                    
                                    <!-- Individual Children -->
                                    {% for child in children %}
                                    <div class="child-card border-2 border-gray-300 bg-white hover:bg-gray-50 transition-all duration-200" 
                                         data-child-id="{{ child.id }}">
                                        <div class="p-3 flex items-center justify-between">
                                            <div class="flex items-center cursor-pointer" onclick="selectChild('{{ child.id }}')">
                                                <div class="w-8 h-8 border-2 border-primary flex items-center justify-center text-white font-normal text-sm mr-3" 
                                                     style="background-color: {{ child.colour }};">
                                                    {{ child.name|first|upper }}
                                                </div>
                                                <div>
                                                    <h3 class="text-sm font-medium text-gray-900">{{ child.name }}</h3>
                                                    {% if child.school %}
                                                        <p class="text-xs text-gray-600">{{ child.school }}</p>
                                                    {% endif %}
                                                    {% if child.year or child.class_name %}
                                                        <p class="text-xs text-gray-500">
                                                            {% if child.year %}Year {{ child.year }}{% endif %}
                                                            {% if child.class_name %} - {{ child.class_name }}{% endif %}
                                                        </p>
                                                    {% endif %}
                                                </div>
                                            </div>
                                            <div class="flex items-center gap-2">
                                                <button onclick="openEditChildModal('{{ child.id }}', {
                                                    name: '{{ child.name|escapejs }}',
                                                    birth_date: '{{ child.birth_date|date:'Y-m-d' }}',
                                                    school: '{{ child.school|default_if_none:''|escapejs }}',
                                                    year: '{{ child.year|default_if_none:''|escapejs }}',
                                                    class_name: '{{ child.class_name|default_if_none:''|escapejs }}',
                                                    colour: '{{ child.colour }}'
                                                })" class="text-gray-400 hover:text-primary transition-colors duration-200">
                                                    <i class="fas fa-pencil-alt"></i>
                                                </button>
                                                <button onclick="deleteChildConfirm('{{ child.id }}', '{{ child.name|escapejs }}')" class="text-red-400 hover:text-red-600 transition-colors duration-200">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Middle Column: Timeline (same width as child page) -->
                <div class="md:col-span-6 lg:col-span-6 xl:col-span-6 h-full min-h-0">
                    <div class="bg-white border-2 border-primary shadow-lg h-full min-h-0 flex flex-col">
                        <div class="border-b-2 border-primary bg-gray-50 px-3 py-2 sm:px-6 sm:py-4 flex-shrink-0">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-normal text-gray-900 tracking-wide child-header-text">Tasks & Events</h3>
                                <div class="flex items-center gap-2">
                                    <nav class="flex gap-2">
                                        <a href="?type=" class="py-2 px-4 border-2 font-normal text-sm tracking-wide transition-all duration-200 {% if not request.GET.type %}bg-primary text-white border-primary{% else %}bg-white text-gray-700 border-gray-300 hover:border-primary hover:text-primary{% endif %}">
                                            All
                                        </a>
                                        <a href="?type=task" class="py-2 px-4 border-2 font-normal text-sm tracking-wide transition-all duration-200 {% if request.GET.type == 'task' %}bg-amber-600 text-white border-amber-600{% else %}bg-white text-gray-700 border-gray-300 hover:border-amber-600 hover:text-amber-600{% endif %}">
                                            Tasks
                                        </a>
                                        <a href="?type=event" class="py-2 px-4 border-2 font-normal text-sm tracking-wide transition-all duration-200 {% if request.GET.type == 'event' %}bg-violet-600 text-white border-violet-600{% else %}bg-white text-gray-700 border-gray-300 hover:border-violet-600 hover:text-violet-600{% endif %}">
                                            Events
                                        </a>
                                    </nav>
                                    <div class="border-l-2 border-primary pl-3 flex items-center justify-center">
                                        <button onclick="openAddEntryModal()" class="bg-primary hover:bg-secondary text-white font-normal px-4 py-3 border-2 border-primary transition-all duration-200 tracking-wide text-sm hover:shadow-lg flex items-center justify-center">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Entry Form -->
                        <div id="entryFormDesktop" class="hidden border-b-2 border-primary bg-gray-25 p-3 rounded-none" style="border-radius: 0;">
                            <form method="post" class="space-y-3">
                                {% csrf_token %}
                                <input type="hidden" name="add_entry" value="1">
                                <input type="hidden" id="selectedChildInputDesktop" name="selected_child" value="">
                                
                                <!-- Row 1: Child (conditionally shown) and Title -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <div id="childFieldDesktop" class="child-field">
                                        <label for="{{ form.child.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Child</label>
                                        {{ form.child }}
                                    </div>
                                    <div>
                                        <label for="{{ form.title.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                                        {{ form.title }}
                                    </div>
                                </div>
                                
                                <!-- Row 2: Type and Category -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <div>
                                        <label for="{{ form.entry_type.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Type</label>
                                        {{ form.entry_type }}
                                    </div>
                                    <div>
                                        <label for="{{ form.category.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                                        {{ form.category }}
                                    </div>
                                </div>
                                
                                <!-- Row 3: Description (full width) -->
                                <div>
                                    <label for="{{ form.description.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                    {{ form.description }}
                                </div>
                                
                                <div class="flex gap-2">
                                    <button type="submit" class="bg-primary hover:bg-secondary text-white font-normal py-1 px-3 border-2 border-primary transition-all duration-200 tracking-wide text-sm rounded-none" style="border-radius: 0;">
                                        Save Entry
                                    </button>
                                    <button type="button" onclick="openAddEntryModal()" class="bg-gray-300 hover:bg-gray-400 text-gray-700 font-normal py-1 px-3 border-2 border-gray-300 transition-all duration-200 tracking-wide text-sm rounded-none" style="border-radius: 0;">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <!-- Timeline Content -->
                        <div class="p-4 overflow-y-auto flex-1 min-h-0">
                            <!-- Collapse all button moved to header -->
                            {% if active_entries %}
                                <div class="space-y-4 flex-1 min-h-0 overflow-y-auto">
                                    {% for entry in active_entries %}
                                        <div class="{% if entry.entry_type == 'task' %}bg-amber-50 border-l-4 border-amber-600{% elif entry.entry_type == 'event' %}bg-violet-50 border-l-4 border-violet-600{% endif %} p-4 hover:bg-opacity-80 transition-all duration-200" 
                                             data-child-id="{{ entry.child.id }}">
                                            <div class="flex justify-between items-start">
                                                <div class="flex items-start gap-3 flex-1 overflow-y-auto" style="max-height: 40vh;">
                                                    <div class="w-6 h-6 border border-primary flex items-center justify-center text-white font-normal text-xs flex-shrink-0 mt-1" 
                                                         style="background-color: {{ entry.child.colour }};">
                                                        {{ entry.child.name|first|upper }}
                                                    </div>
                                                    <div class="flex-1">
                                                        <h4 class="font-medium text-gray-900">{{ entry.title }}</h4>
                                                        <p class="text-gray-600 text-sm mt-1">{{ entry.description|truncatewords:20 }}</p>
                                                        <div class="flex items-center gap-4 mt-2 text-sm text-gray-500">
                                                            <span>{{ entry.created_at|date:"M d, Y" }}</span>
                                                            {% if entry.due_date %}
                                                                <span>Due: {{ entry.due_date|date:"M d" }}</span>
                                                            {% endif %}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="flex items-center gap-2">
                                                    <button onclick="openEditEntryModal('{{ entry.id }}', '{{ entry.child.id }}', '{{ entry.category }}', '{{ entry.title|escapejs }}', '{{ entry.content|escapejs }}', '{{ entry.date|date:'Y-m-d' }}')" class="text-gray-400 hover:text-primary transition-colors duration-200">
                                                        <i class="fas fa-pencil-alt"></i>
                                                    </button>
                                                    <button onclick="deleteEntryConfirm('{{ entry.id }}', '{{ entry.title|escapejs }}')" class="text-red-400 hover:text-red-600 transition-colors duration-200">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    {% endfor %}
                                </div>
                            {% else %}
                                <div class="text-center py-12">
                                    <div class="w-16 h-16 mx-auto mb-4 bg-gray-100 border-2 border-primary flex items-center justify-center">
                                        <i class="fas fa-calendar-plus text-primary text-xl"></i>
                                    </div>
                                    <p class="text-gray-600 font-normal tracking-wide mb-4">No entries yet</p>
                                    <button onclick="openAddEntryModal()" class="bg-primary hover:bg-secondary text-white font-normal py-2 px-4 border-2 border-primary transition-all duration-200 tracking-wide hover:shadow-lg">
                                        Add First Entry
                                    </button>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Right Column: Notes (same width as child page) -->
                <div class="md:col-span-4 lg:col-span-4 xl:col-span-4 h-full">
                    <div class="bg-white border-2 border-green-600 shadow-lg h-full flex flex-col">
                        <div class="border-b-2 border-green-600 bg-green-50 px-3 py-2 sm:px-6 sm:py-4 flex-shrink-0">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-normal text-green-700 tracking-wide notes-header-text">Notes</h3>
                                <div class="border-l-2 border-primary pl-3 flex items-center justify-center">
                                    <button onclick="openAddNoteModal()" class="bg-green-600 hover:bg-green-700 text-white font-normal px-4 py-3 border-2 border-green-600 transition-all duration-200 tracking-wide text-sm hover:shadow-lg flex items-center justify-center">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Notes Form -->
                        <div id="notesFormDesktop" class="hidden border-b-2 border-green-600 bg-green-25 p-3 rounded-none" style="border-radius: 0;">
                            <form method="post" class="space-y-3">
                                {% csrf_token %}
                                <input type="hidden" name="add_note" value="1">
                                
                                <div>
                                    <label for="{{ note_form.child.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Child</label>
                                    {{ note_form.child }}
                                </div>
                                
                                <div>
                                    <label for="{{ note_form.title.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                                    {{ note_form.title }}
                                </div>
                                
                                <div>
                                    <label for="{{ note_form.category.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Category (Optional)</label>
                                    {{ note_form.category }}
                                </div>
                                
                                <div>
                                    <label for="{{ note_form.description.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Note</label>
                                    {{ note_form.description }}
                                </div>
                                
                                {{ note_form.entry_type }}
                                
                                <div class="flex gap-2">
                                    <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-normal py-1 px-3 border-2 border-green-600 transition-all duration-200 tracking-wide text-sm rounded-none" style="border-radius: 0;">
                                        Save Note
                                    </button>
                                    <button type="button" onclick="openAddNoteModal()" class="bg-gray-300 hover:bg-gray-400 text-gray-700 font-normal py-1 px-3 border-2 border-gray-300 transition-all duration-200 tracking-wide text-sm rounded-none" style="border-radius: 0;">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <!-- Notes Content -->
                        <div class="p-4 overflow-y-auto flex-1 min-h-0">
                            <div class="flex justify-end mb-2">
                                <!-- Collapse all button moved to header -->
                            </div>
                            {% if notes %}
                                <div class="space-y-4 flex-1 min-h-0 overflow-y-auto">
                                    {% for note in notes %}
                                        <div class="bg-green-50 border-l-4 border-green-600 p-4 hover:bg-green-100 transition-all duration-200" 
                                             data-child-id="{{ note.child.id }}">
                                            <div class="flex justify-between items-start">
                                                <div class="flex items-start gap-3 flex-1 overflow-y-auto" style="max-height: 40vh;">
                                                    <div class="w-6 h-6 border border-primary flex items-center justify-center text-white font-normal text-xs flex-shrink-0 mt-1" 
                                                         style="background-color: {{ note.child.colour }};">
                                                        {{ note.child.name|first|upper }}
                                                    </div>
                                                    <div class="flex-1">
                                                        <h4 class="font-medium text-gray-900">{{ note.title }}</h4>
                                                        <p class="text-gray-600 text-sm mt-1">{{ note.description|truncatewords:20 }}</p>
                                                        <div class="flex items-center gap-4 mt-2 text-sm text-gray-500">
                                                            <span>{{ note.created_at|date:"M d, Y" }}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="flex items-center gap-2">
                                                    <button onclick="openEditNoteModal('{{ note.id }}', '{{ note.child.id }}', '{{ note.title|escapejs }}', '{{ note.description|escapejs }}', '{{ note.date|date:'Y-m-d' }}')" class="text-gray-400 hover:text-green-600 transition-colors duration-200">
                                                        <i class="fas fa-pencil-alt"></i>
                                                    </button>
                                                    <button onclick="deleteNoteConfirm('{{ note.id }}', '{{ note.title|escapejs }}')" class="text-red-400 hover:text-red-600 transition-colors duration-200">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    {% endfor %}
                                </div>
                            {% else %}
                                <div class="text-center py-12">
                                    <div class="w-16 h-16 mx-auto mb-4 bg-green-100 border-2 border-green-600 flex items-center justify-center">
                                        <i class="fas fa-sticky-note text-green-600 text-xl"></i>
                                    </div>
                                    <p class="text-gray-600 font-normal tracking-wide mb-4">No notes yet</p>
                                    <button onclick="openAddNoteModal()" class="bg-green-600 hover:bg-green-700 text-white font-normal py-2 px-4 border-2 border-green-600 transition-all duration-200 tracking-wide hover:shadow-lg">
                                        Add First Note
                                    </button>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}